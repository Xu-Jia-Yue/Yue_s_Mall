import{a4 as H,a5 as C,d as O,r as h,o as k,a as E,c as S,b as L,e as m,w as v,n as F,t as V,v as G,F as M,g as P,u as U,a6 as j,a7 as x,j as R,_ as $}from"./index-B75pHzMF.js";import{E as q,a as z}from"./el-tab-pane-BYOIa8nG.js";import{E as K,a as Y}from"./el-breadcrumb-item-BfaUJm9H.js";import{G as J}from"./GoodsItem-3mL0dEJt.js";import{t as Q}from"./event-BE20p1dL.js";import{g as W}from"./scroll-CkC0sI4r.js";import{t as A}from"./throttle-BNAXIpr9.js";import"./index-YlUhqEa-.js";import"./vnode-BUxZuyNd.js";import"./debounce-BNDKjuDs.js";const B=e=>{let o=0,t=e;for(;t;)o+=t.offsetTop,t=t.offsetParent;return o},X=(e,o)=>Math.abs(B(e)-B(o)),l="ElInfiniteScroll",Z=50,ee=200,te=0,oe={delay:{type:Number,default:ee},distance:{type:Number,default:te},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},I=(e,o)=>Object.entries(oe).reduce((t,[n,a])=>{var i,r;const{type:f,default:u}=a,d=e.getAttribute(`infinite-scroll-${n}`);let s=(r=(i=o[d])!=null?i:d)!=null?r:u;return s=s==="false"?!1:s,s=f(s),t[n]=Number.isNaN(s)?u:s,t},{}),D=e=>{const{observer:o}=e[l];o&&(o.disconnect(),delete e[l].observer)},ne=(e,o)=>{const{container:t,containerEl:n,instance:a,observer:i,lastScrollTop:r}=e[l],{disabled:f,distance:u}=I(e,a),{clientHeight:d,scrollHeight:s,scrollTop:c}=n,p=c-r;if(e[l].lastScrollTop=c,i||f||p<0)return;let b=!1;if(t===e)b=s-(d+c)<=u;else{const{clientTop:_,scrollHeight:T}=e,y=X(e,n);b=c+d>=y+_+T-u}b&&o.call(a)};function w(e,o){const{containerEl:t,instance:n}=e[l],{disabled:a}=I(e,n);a||t.clientHeight===0||(t.scrollHeight<=t.clientHeight?o.call(n):D(e))}const ae={async mounted(e,o){const{instance:t,value:n}=o;H(n)||Q(l,"'v-infinite-scroll' binding value must be a function"),await C();const{delay:a,immediate:i}=I(e,t),r=W(e,!0),f=r===window?document.documentElement:r,u=A(ne.bind(null,e,n),a);if(r){if(e[l]={instance:t,container:r,containerEl:f,delay:a,cb:n,onScroll:u,lastScrollTop:f.scrollTop},i){const d=new MutationObserver(A(w.bind(null,e,n),Z));e[l].observer=d,d.observe(e,{childList:!0,subtree:!0}),w(e,n)}r.addEventListener("scroll",u)}},unmounted(e){if(!e[l])return;const{container:o,onScroll:t}=e[l];o==null||o.removeEventListener("scroll",t),D(e)},async updated(e){if(!e[l])await C();else{const{containerEl:o,cb:t,observer:n}=e[l];o.clientHeight&&n&&w(e,t)}}},N=ae;N.install=e=>{e.directive("InfiniteScroll",N)};const se=N,re={class:"container"},le={class:"bread-container"},ie={class:"sub-container"},ce={class:"body"},ue=O({__name:"index",setup(e){const o=U(),t=h({}),n=async s=>{const{result:c}=await j(s);t.value=c},a=h({categoryId:o.params.id,page:1,pageSize:20,sortField:"publishTime"}),i=h([]),r=async s=>{const{result:c}=await x(s);i.value=c.items},f=()=>{a.value.page=1,r(a.value)},u=h(!1),d=async()=>{a.value.page++;const s=await x(a.value);i.value=[...i.value,...s.result.items],s.result.items.length===0&&(u.value=!0)};return k(()=>{r(a),n(o.params.id)}),(s,c)=>{const p=K,b=Y,_=q,T=z,y=se;return E(),S("div",re,[L("div",le,[m(b,{separator:">"},{default:v(()=>[m(p,{to:{path:"/"}},{default:v(()=>[F("首页")]),_:1}),m(p,{to:`/category/${t.value.parentId}`},{default:v(()=>[F(V(t.value.parentName),1)]),_:1},8,["to"]),m(p,null,{default:v(()=>[F(V(t.value.name),1)]),_:1})]),_:1})]),L("div",ie,[m(T,{modelValue:a.value.sortField,"onUpdate:modelValue":c[0]||(c[0]=g=>a.value.sortField=g),onTabChange:f},{default:v(()=>[m(_,{label:"最新商品",name:"publishTime"}),m(_,{label:"最高人气",name:"orderNum"}),m(_,{label:"评论最多",name:"evaluateNum"})]),_:1},8,["modelValue"]),G((E(),S("div",ce,[(E(!0),S(M,null,P(i.value,g=>(E(),R(J,{goods:g,key:g.id},null,8,["goods"]))),128))])),[[y,d]])])])}}}),Te=$(ue,[["__scopeId","data-v-05574b2a"]]);export{Te as default};
